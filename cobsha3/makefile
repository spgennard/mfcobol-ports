EXE_EXT=
SO_EXT=.so
KECCAK_CBL=KECCAK.cob
LIB_KECCAK=-L. -lKECCAK

all:	SHAKE128$(SO_EXT) SHAKE256$(SO_EXT) SHA3_224$(SO_EXT) \
        SHA3_256$(SO_EXT) SHA3_384$(SO_EXT) SHA3_512$(SO_EXT) KECCAK.o \
        TESTSHA3$(EXE_EXT) SHA3_512.o   SESSION_ID.o TEST_SESSION_ID$(EXE_EXT) \
        SHA3_256.o   SESSION_ID_256.o TEST_SESSION_ID_256$(EXE_EXT)

# SESSION_ID        cobccob -
TEST_SESSION_ID$(EXE_EXT):	TEST_SESSION_ID.cob
	cob -gxU TEST_SESSION_ID.cob $(LIB_KECCAK)

SESSION_ID.o:	SESSION_ID.cob SHA3_512.o
	cob -gzU SESSION_ID.cob SHA3_512.o
    
SHA3_512.o:	SHA3_512.cob
	cob -gvxc -xc 'sourceformat(free)' SHA3_512.cob

# SESSION_ID_256
TEST_SESSION_ID_256$(EXE_EXT):	TEST_SESSION_ID_256.cob
	cob -gxU TEST_SESSION_ID_256.cob  $(LIB_KECCAK)

SESSION_ID_256.o:	SESSION_ID_256.cob SHA3_256.o
	cob -gzU SESSION_ID_256.cob SHA3_256.o
    
SHA3_256.o:	SHA3_256.cob
	cob -gvxc 'sourceformat(free)' SHA3_256.cob  $(LIB_KECCAK)
    
# SHA3    
TESTSHA3$(EXE_EXT):	TESTSHA3.cob
	cob -gxU TESTSHA3.cob $(LIB_KECCAK)
    
SHAKE128$(SO_EXT):	SHAKE128.cob 
	cob -gzU SHAKE128.cob $(LIB_KECCAK)
    
SHAKE256$(SO_EXT):	SHAKE256.cob
	cob -gzU SHAKE256.cob $(LIB_KECCAK)

SHA3_224$(SO_EXT): SHA3_224.cob
	cob -gzU SHA3_224.cob $(LIB_KECCAK)

SHA3_256$(SO_EXT):	SHA3_256.cob
	cob -gzU SHA3_256.cob $(LIB_KECCAK)
    
SHA3_384$(SO_EXT):	SHA3_384.cob
	cob -gzU SHA3_384.cob $(LIB_KECCAK)
    
SHA3_512$(SO_EXT):	SHA3_512.cob
	cob -gzU SHA3_512.cob $(LIB_KECCAK)
    
KECCAK.o:	KECCAK.cob
	cob -gvZ -o libKECCAK.so KECCAK.cob 

clean:
	rm -f KECCAK.o
	rm -f KECCAK$(SO_EXT)
	rm -f SHAKE128$(SO_EXT)
	rm -f SHAKE256$(SO_EXT)
	rm -f SHA3_224$(SO_EXT)
	rm -f SHA3_256$(SO_EXT)
	rm -f SHA3_384$(SO_EXT)
	rm -f SHA3_512$(SO_EXT)
	rm -f TESTSHA3$(EXE_EXT)
	rm -f SHA3_256.o
	rm -f SESSION_ID_256$(SO_EXT)
	rm -f TEST_SESSION_ID_256$(EXE_EXT)
	rm -f SHA3_512.o
	rm -f SESSION_ID$(SO_EXT)
	rm -f TEST_SESSION_ID$(EXE_EXT)
